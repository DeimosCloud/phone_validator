---
- name: Allow incoming traffic on specified TCP ports
  iptables:
    chain: INPUT
    protocol: tcp
    destination_port: "{{ item }}"
    jump: ACCEPT
  with_items: "{{ allowed_tcp_ports }}"

- name: Set default policy for INPUT chain to DROP
  iptables:
    chain: INPUT
    policy: DROP


- name: Allow incoming traffic from specified IP addresses
  iptables:
    chain: INPUT
    source: "{{ item }}"
    jump: ACCEPT
  with_items: "{{ allowed_tcp_ips }}"


